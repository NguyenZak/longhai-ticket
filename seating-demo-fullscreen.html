<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Seating System - Fullscreen & Grid Toggle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', system-ui, sans-serif;
        }
        .canvas-container {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        .seat {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .seat:hover {
            transform: scale(1.05);
        }
        .seat.selected {
            stroke: #3b82f6;
            stroke-width: 3;
        }
        .fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999;
            background-color: #f8fafc;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen">
        <!-- Header -->
        <div class="bg-white border-b border-gray-200 px-6 py-4">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">üé® Seating System Demo</h1>
                    <p class="text-gray-600">T√≠nh nƒÉng Full m√†n h√¨nh v√† Toggle Grid</p>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="toggleGrid" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        üìê B·∫≠t/T·∫Øt L∆∞·ªõi
                    </button>
                    <button id="toggleFullscreen" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        ‚õ∂ Full M√†n h√¨nh
                    </button>
                    <button id="resetView" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                        üîÑ Reset View
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto p-6">
            <!-- Instructions -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <h3 class="font-semibold text-blue-900 mb-2">üìã H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800">
                    <div>
                        <strong>üé® V·∫Ω gh·∫ø:</strong>
                        <ul class="mt-1 space-y-1">
                            <li>‚Ä¢ Click tr√°i: V·∫Ω gh·∫ø ƒë∆°n l·∫ª</li>
                            <li>‚Ä¢ Click gi·ªØa: Di chuy·ªÉn view</li>
                            <li>‚Ä¢ Double-click: S·ª≠a t√™n gh·∫ø</li>
                            <li>‚Ä¢ Scroll: Zoom in/out</li>
                        </ul>
                    </div>
                    <div>
                        <strong>‚öôÔ∏è T√≠nh nƒÉng m·ªõi:</strong>
                        <ul class="mt-1 space-y-1">
                            <li>‚Ä¢ üìê B·∫≠t/T·∫Øt l∆∞·ªõi ƒë·ªÉ v·∫Ω ch√≠nh x√°c</li>
                            <li>‚Ä¢ ‚õ∂ Full m√†n h√¨nh ƒë·ªÉ v·∫Ω d·ªÖ d√†ng</li>
                            <li>‚Ä¢ üîÑ Reset view v·ªÅ v·ªã tr√≠ ban ƒë·∫ßu</li>
                            <li>‚Ä¢ üéØ Zoom t·ª´ 10% ƒë·∫øn 500%</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Canvas Container -->
            <div id="canvasContainer" class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
                <!-- Toolbar -->
                <div class="bg-gradient-to-r from-gray-900 to-gray-800 px-6 py-4 border-b border-gray-700">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-white font-medium">üé®</span>
                                <span class="text-white font-medium">C√¥ng c·ª• v·∫Ω</span>
                            </div>
                            <div class="h-6 w-px bg-gray-600"></div>
                            <div class="flex items-center space-x-1 bg-gray-800 rounded-lg p-1">
                                <button id="drawSingle" class="px-3 py-2 rounded-md text-sm font-medium bg-blue-600 text-white shadow-sm">
                                    ‚úèÔ∏è V·∫Ω gh·∫ø
                                </button>
                                <button id="drawRow" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700">
                                    üìè V·∫Ω h√†ng
                                </button>
                                <button id="eraseMode" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700">
                                    üóëÔ∏è X√≥a
                                </button>
                            </div>
                            <div class="h-6 w-px bg-gray-600"></div>
                            <div class="flex items-center space-x-2">
                                <span class="text-gray-300 text-sm font-medium">Lo·∫°i v√©:</span>
                                <select id="ticketType" class="bg-gray-800 border border-gray-600 text-white text-sm rounded-md px-3 py-2">
                                    <option value="">Ch·ªçn lo·∫°i v√©</option>
                                    <option value="vip">VIP - 500,000ƒë</option>
                                    <option value="premium">Premium - 300,000ƒë</option>
                                    <option value="standard">Th∆∞·ªùng - 200,000ƒë</option>
                                    <option value="economy">Ti·∫øt ki·ªám - 150,000ƒë</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-gray-300 text-sm font-medium">Zoom:</span>
                                <button id="zoomOut" class="w-8 h-8 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors">-</button>
                                <span id="zoomLevel" class="text-white text-sm font-medium min-w-[60px] text-center">100%</span>
                                <button id="zoomIn" class="w-8 h-8 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors">+</button>
                            </div>
                            <button id="resetViewBtn" class="px-4 py-2 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm font-medium">
                                üîÑ Reset View
                            </button>
                            <div class="h-6 w-px bg-gray-600"></div>
                            <button id="toggleGridBtn" class="px-4 py-2 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm font-medium">
                                üìê B·∫≠t l∆∞·ªõi
                            </button>
                            <button id="toggleFullscreenBtn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium">
                                ‚õ∂ Full m√†n h√¨nh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Canvas -->
                <div class="canvas-container relative">
                    <canvas id="seatingCanvas" width="1000" height="700" class="cursor-crosshair"></canvas>
                    
                    <!-- Instructions overlay -->
                    <div id="instructions" class="absolute inset-0 flex items-center justify-center bg-gray-50 bg-opacity-50">
                        <div class="text-center p-8 bg-white rounded-xl shadow-lg border border-gray-200 max-w-md">
                            <div class="text-4xl mb-4">üé®</div>
                            <h3 class="text-xl font-semibold text-gray-900 mb-2">
                                B·∫Øt ƒë·∫ßu v·∫Ω s∆° ƒë·ªì gh·∫ø
                            </h3>
                            <p class="text-gray-600 mb-4">
                                Ch·ªçn c√¥ng c·ª• v·∫Ω v√† click v√†o canvas ƒë·ªÉ t·∫°o gh·∫ø. S·ª≠ d·ª•ng chu·ªôt gi·ªØa ƒë·ªÉ di chuy·ªÉn view.
                            </p>
                            <div class="grid grid-cols-2 gap-4 text-sm text-gray-500">
                                <div>üñ±Ô∏è Click tr√°i: V·∫Ω gh·∫ø</div>
                                <div>üñ±Ô∏è Click gi·ªØa: Di chuy·ªÉn</div>
                                <div>üñ±Ô∏è Double-click: S·ª≠a t√™n</div>
                                <div>üîç Scroll: Zoom in/out</div>
                            </div>
                        </div>
                    </div>

                    <!-- Zoom indicator -->
                    <div id="zoomIndicator" class="absolute bottom-4 right-4 bg-black bg-opacity-75 text-white px-3 py-2 rounded-lg text-sm font-medium">
                        100%
                    </div>

                    <!-- Fullscreen indicator -->
                    <div id="fullscreenIndicator" class="absolute top-4 left-4 bg-black bg-opacity-75 text-white px-3 py-2 rounded-lg text-sm font-medium hidden">
                        ‚õ∂ Ch·∫ø ƒë·ªô full m√†n h√¨nh
                    </div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <div class="text-2xl font-bold text-blue-600" id="totalSeats">0</div>
                    <div class="text-sm text-gray-600">T·ªïng gh·∫ø</div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <div class="text-2xl font-bold text-green-600" id="availableSeats">0</div>
                    <div class="text-sm text-gray-600">C√≥ s·∫µn</div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <div class="text-2xl font-bold text-red-600" id="occupiedSeats">0</div>
                    <div class="text-sm text-gray-600">ƒê√£ ƒë·∫∑t</div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <div class="text-2xl font-bold text-orange-600" id="reservedSeats">0</div>
                    <div class="text-sm text-gray-600">ƒê√£ gi·ªØ</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SeatingCanvas {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.seats = [];
                this.selectedSeat = null;
                this.drawMode = 'single';
                this.zoom = 1;
                this.pan = { x: 0, y: 0 };
                this.isPanning = false;
                this.lastPanPoint = { x: 0, y: 0 };
                this.showGrid = false;
                this.isFullscreen = false;
                this.selectedTicketType = null;

                this.ticketTypes = [
                    { id: 'vip', name: 'VIP', price: 500000, color: '#FFD700' },
                    { id: 'premium', name: 'Premium', price: 300000, color: '#FF6B6B' },
                    { id: 'standard', name: 'Th∆∞·ªùng', price: 200000, color: '#4CAF50' },
                    { id: 'economy', name: 'Ti·∫øt ki·ªám', price: 150000, color: '#9E9E9E' }
                ];

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.draw();
                this.updateStatistics();
            }

            setupEventListeners() {
                this.canvas.addEventListener('mousedown', this.handleMouseDown.bind(this));
                this.canvas.addEventListener('mousemove', this.handleMouseMove.bind(this));
                this.canvas.addEventListener('mouseup', this.handleMouseUp.bind(this));
                this.canvas.addEventListener('wheel', this.handleWheel.bind(this));
                this.canvas.addEventListener('dblclick', this.handleDoubleClick.bind(this));
                this.canvas.addEventListener('contextmenu', (e) => e.preventDefault());

                // Toolbar buttons
                document.getElementById('drawSingle').addEventListener('click', () => this.setDrawMode('single'));
                document.getElementById('drawRow').addEventListener('click', () => this.setDrawMode('row'));
                document.getElementById('eraseMode').addEventListener('click', () => this.setDrawMode('erase'));
                document.getElementById('zoomIn').addEventListener('click', () => this.zoomIn());
                document.getElementById('zoomOut').addEventListener('click', () => this.zoomOut());
                document.getElementById('resetViewBtn').addEventListener('click', () => this.resetView());
                document.getElementById('toggleGridBtn').addEventListener('click', () => this.toggleGrid());
                document.getElementById('toggleFullscreenBtn').addEventListener('click', () => this.toggleFullscreen());

                // Ticket type selector
                document.getElementById('ticketType').addEventListener('change', (e) => {
                    this.selectedTicketType = this.ticketTypes.find(t => t.id === e.target.value);
                });

                // Header buttons
                document.getElementById('toggleGrid').addEventListener('click', () => this.toggleGrid());
                document.getElementById('toggleFullscreen').addEventListener('click', () => this.toggleFullscreen());
                document.getElementById('resetView').addEventListener('click', () => this.resetView());
            }

            setDrawMode(mode) {
                this.drawMode = mode;
                
                // Update button styles
                document.getElementById('drawSingle').className = 
                    `px-3 py-2 rounded-md text-sm font-medium transition-colors ${mode === 'single' ? 'bg-blue-600 text-white shadow-sm' : 'text-gray-300 hover:text-white hover:bg-gray-700'}`;
                document.getElementById('drawRow').className = 
                    `px-3 py-2 rounded-md text-sm font-medium transition-colors ${mode === 'row' ? 'bg-blue-600 text-white shadow-sm' : 'text-gray-300 hover:text-white hover:bg-gray-700'}`;
                document.getElementById('eraseMode').className = 
                    `px-3 py-2 rounded-md text-sm font-medium transition-colors ${mode === 'erase' ? 'bg-red-600 text-white shadow-sm' : 'text-gray-300 hover:text-white hover:bg-gray-700'}`;
            }

            getMousePos(e) {
                const rect = this.canvas.getBoundingClientRect();
                const x = (e.clientX - rect.left - this.pan.x) / this.zoom;
                const y = (e.clientY - rect.top - this.pan.y) / this.zoom;
                return { x, y };
            }

            findSeatAtPosition(x, y) {
                return this.seats.find(seat => 
                    x >= seat.x && x <= seat.x + seat.width &&
                    y >= seat.y && y <= seat.y + seat.height
                ) || null;
            }

            handleMouseDown(e) {
                const mousePos = this.getMousePos(e);
                
                if (e.button === 1 || e.button === 2) { // Middle or right click
                    this.isPanning = true;
                    this.lastPanPoint = { x: e.clientX, y: e.clientY };
                    return;
                }

                const existingSeat = this.findSeatAtPosition(mousePos.x, mousePos.y);
                
                if (existingSeat) {
                    if (this.drawMode === 'erase') {
                        this.seats = this.seats.filter(s => s.id !== existingSeat.id);
                        this.updateStatistics();
                    } else {
                        this.selectedSeat = existingSeat;
                        this.showSeatInspector(e.clientX, e.clientY);
                    }
                    this.draw();
                    return;
                }

                if (this.drawMode === 'single') {
                    const newSeat = {
                        id: `seat-${Date.now()}-${Math.random()}`,
                        row: Math.floor(mousePos.y / 40) + 1,
                        column: Math.floor(mousePos.x / 40) + 1,
                        x: Math.floor(mousePos.x / 40) * 40,
                        y: Math.floor(mousePos.y / 40) * 40,
                        width: 35,
                        height: 35,
                        status: 'available',
                        ticketType: this.selectedTicketType?.id,
                        price: this.selectedTicketType?.price,
                        color: this.selectedTicketType?.color,
                        category: this.selectedTicketType?.name,
                        seatName: `${Math.floor(mousePos.y / 40) + 1}-${Math.floor(mousePos.x / 40) + 1}`,
                        rowName: `H√†ng ${Math.floor(mousePos.y / 40) + 1}`
                    };
                    
                    this.seats.push(newSeat);
                    this.updateStatistics();
                    this.draw();
                }
            }

            handleMouseMove(e) {
                if (this.isPanning) {
                    const deltaX = e.clientX - this.lastPanPoint.x;
                    const deltaY = e.clientY - this.lastPanPoint.y;
                    this.pan.x += deltaX;
                    this.pan.y += deltaY;
                    this.lastPanPoint = { x: e.clientX, y: e.clientY };
                    this.draw();
                }
            }

            handleMouseUp() {
                this.isPanning = false;
            }

            handleWheel(e) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                this.zoom = Math.max(0.1, Math.min(5, this.zoom * delta));
                this.updateZoomDisplay();
                this.draw();
            }

            handleDoubleClick(e) {
                const mousePos = this.getMousePos(e);
                const seat = this.findSeatAtPosition(mousePos.x, mousePos.y);
                
                if (seat) {
                    const newName = prompt('Nh·∫≠p t√™n gh·∫ø m·ªõi:', seat.seatName || '');
                    if (newName !== null) {
                        seat.seatName = newName;
                        this.draw();
                    }
                }
            }

            zoomIn() {
                this.zoom = Math.min(5, this.zoom * 1.2);
                this.updateZoomDisplay();
                this.draw();
            }

            zoomOut() {
                this.zoom = Math.max(0.1, this.zoom / 1.2);
                this.updateZoomDisplay();
                this.draw();
            }

            resetView() {
                this.zoom = 1;
                this.pan = { x: 0, y: 0 };
                this.updateZoomDisplay();
                this.draw();
            }

            toggleGrid() {
                this.showGrid = !this.showGrid;
                const btn = document.getElementById('toggleGridBtn');
                btn.textContent = this.showGrid ? 'üìê T·∫Øt l∆∞·ªõi' : 'üìê B·∫≠t l∆∞·ªõi';
                btn.className = this.showGrid 
                    ? 'px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm font-medium'
                    : 'px-4 py-2 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm font-medium';
                this.draw();
            }

            toggleFullscreen() {
                this.isFullscreen = !this.isFullscreen;
                const container = document.getElementById('canvasContainer');
                const indicator = document.getElementById('fullscreenIndicator');
                const btn = document.getElementById('toggleFullscreenBtn');
                
                if (this.isFullscreen) {
                    container.classList.add('fullscreen');
                    indicator.classList.remove('hidden');
                    btn.textContent = '‚õå Tho√°t full m√†n h√¨nh';
                    btn.className = 'px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium';
                    
                    // Resize canvas to fullscreen
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight - 80;
                } else {
                    container.classList.remove('fullscreen');
                    indicator.classList.add('hidden');
                    btn.textContent = '‚õ∂ Full m√†n h√¨nh';
                    btn.className = 'px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium';
                    
                    // Reset canvas size
                    this.canvas.width = 1000;
                    this.canvas.height = 700;
                }
                
                this.draw();
            }

            updateZoomDisplay() {
                document.getElementById('zoomLevel').textContent = `${Math.round(this.zoom * 100)}%`;
                document.getElementById('zoomIndicator').textContent = `${Math.round(this.zoom * 100)}%`;
            }

            showSeatInspector(x, y) {
                const seat = this.selectedSeat;
                if (!seat) return;

                const inspector = document.createElement('div');
                inspector.className = 'absolute bg-white rounded-xl shadow-xl border border-gray-200 p-6 min-w-[320px] z-50';
                inspector.style.left = `${x + 10}px`;
                inspector.style.top = `${y - 10}px`;
                inspector.style.transform = 'translateY(-100%)';

                inspector.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-gray-900">Ch·ªânh s·ª≠a gh·∫ø</h4>
                        <button class="text-gray-400 hover:text-gray-600" onclick="this.parentElement.parentElement.remove()">‚úï</button>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">T√™n gh·∫ø</label>
                            <input type="text" value="${seat.seatName || ''}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i v√©</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm">
                                ${this.ticketTypes.map(type => 
                                    `<option value="${type.id}" ${seat.ticketType === type.id ? 'selected' : ''}>
                                        ${type.name} - ${type.price.toLocaleString()}ƒë
                                    </option>`
                                ).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tr·∫°ng th√°i</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm">
                                <option value="available" ${seat.status === 'available' ? 'selected' : ''}>C√≥ s·∫µn</option>
                                <option value="occupied" ${seat.status === 'occupied' ? 'selected' : ''}>ƒê√£ ƒë·∫∑t</option>
                                <option value="reserved" ${seat.status === 'reserved' ? 'selected' : ''}>ƒê√£ gi·ªØ</option>
                                <option value="disabled" ${seat.status === 'disabled' ? 'selected' : ''}>V√¥ hi·ªáu</option>
                            </select>
                        </div>
                        <div class="flex space-x-3 pt-2">
                            <button class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium shadow-sm" onclick="seatingCanvas.deleteSeat('${seat.id}')">X√≥a gh·∫ø</button>
                            <button class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium shadow-sm" onclick="this.parentElement.parentElement.parentElement.remove()">ƒê√≥ng</button>
                        </div>
                    </div>
                `;

                document.body.appendChild(inspector);

                // Handle input changes
                const nameInput = inspector.querySelector('input');
                const ticketSelect = inspector.querySelector('select:nth-of-type(1)');
                const statusSelect = inspector.querySelector('select:nth-of-type(2)');

                nameInput.addEventListener('input', (e) => {
                    seat.seatName = e.target.value;
                    this.draw();
                });

                ticketSelect.addEventListener('change', (e) => {
                    const type = this.ticketTypes.find(t => t.id === e.target.value);
                    seat.ticketType = e.target.value;
                    seat.price = type?.price;
                    seat.color = type?.color;
                    seat.category = type?.name;
                    this.draw();
                });

                statusSelect.addEventListener('change', (e) => {
                    seat.status = e.target.value;
                    this.draw();
                    this.updateStatistics();
                });
            }

            deleteSeat(seatId) {
                this.seats = this.seats.filter(s => s.id !== seatId);
                this.updateStatistics();
                this.draw();
                document.querySelector('.absolute.bg-white.rounded-xl').remove();
            }

            updateStatistics() {
                document.getElementById('totalSeats').textContent = this.seats.length;
                document.getElementById('availableSeats').textContent = this.seats.filter(s => s.status === 'available').length;
                document.getElementById('occupiedSeats').textContent = this.seats.filter(s => s.status === 'occupied').length;
                document.getElementById('reservedSeats').textContent = this.seats.filter(s => s.status === 'reserved').length;

                // Hide instructions if seats exist
                const instructions = document.getElementById('instructions');
                if (this.seats.length > 0) {
                    instructions.style.display = 'none';
                } else {
                    instructions.style.display = 'flex';
                }
            }

            draw() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;

                // Clear canvas
                ctx.clearRect(0, 0, width, height);

                // Apply zoom and pan
                ctx.save();
                ctx.translate(this.pan.x, this.pan.y);
                ctx.scale(this.zoom, this.zoom);

                // Draw background gradient
                const gradient = ctx.createLinearGradient(0, 0, width, height);
                gradient.addColorStop(0, '#f8fafc');
                gradient.addColorStop(1, '#e2e8f0');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);

                // Draw grid (only when showGrid is true)
                if (this.showGrid) {
                    ctx.strokeStyle = '#e2e8f0';
                    ctx.lineWidth = 1;
                    const gridSize = 20;
                    
                    for (let x = 0; x <= width; x += gridSize) {
                        ctx.beginPath();
                        ctx.moveTo(x, 0);
                        ctx.lineTo(x, height);
                        ctx.stroke();
                    }
                    
                    for (let y = 0; y <= height; y += gridSize) {
                        ctx.beginPath();
                        ctx.moveTo(0, y);
                        ctx.lineTo(width, y);
                        ctx.stroke();
                    }
                }

                // Draw stage area
                const stageWidth = width * 0.6;
                const stageHeight = 80;
                const stageX = (width - stageWidth) / 2;
                const stageY = 50;

                const stageGradient = ctx.createLinearGradient(stageX, stageY, stageX, stageY + stageHeight);
                stageGradient.addColorStop(0, '#667eea');
                stageGradient.addColorStop(1, '#764ba2');
                
                ctx.fillStyle = stageGradient;
                ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 4;
                ctx.fillRect(stageX, stageY, stageWidth, stageHeight);
                
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;

                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 16px Inter, system-ui, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('üé™ S√ÇN KH·∫§U', stageX + stageWidth / 2, stageY + stageHeight / 2 + 6);

                // Draw seats
                this.seats.forEach(seat => {
                    const isSelected = this.selectedSeat?.id === seat.id;
                    const seatColor = seat.color || '#4CAF50';
                    const statusColor = this.getSeatStatusColor(seat.status);

                    ctx.shadowColor = isSelected ? 'rgba(59, 130, 246, 0.5)' : 'rgba(0, 0, 0, 0.1)';
                    ctx.shadowBlur = isSelected ? 15 : 8;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = isSelected ? 6 : 4;

                    const seatGradient = ctx.createLinearGradient(seat.x, seat.y, seat.x, seat.y + seat.height);
                    seatGradient.addColorStop(0, seatColor);
                    seatGradient.addColorStop(1, this.adjustBrightness(seatColor, -20));

                    ctx.fillStyle = seatGradient;
                    ctx.strokeStyle = isSelected ? '#3b82f6' : '#ffffff';
                    ctx.lineWidth = isSelected ? 3 : 2;

                    const radius = 6;
                    ctx.beginPath();
                    ctx.moveTo(seat.x + radius, seat.y);
                    ctx.lineTo(seat.x + seat.width - radius, seat.y);
                    ctx.quadraticCurveTo(seat.x + seat.width, seat.y, seat.x + seat.width, seat.y + radius);
                    ctx.lineTo(seat.x + seat.width, seat.y + seat.height - radius);
                    ctx.quadraticCurveTo(seat.x + seat.width, seat.y + seat.height, seat.x + seat.width - radius, seat.y + seat.height);
                    ctx.lineTo(seat.x + radius, seat.y + seat.height);
                    ctx.quadraticCurveTo(seat.x, seat.y + seat.height, seat.x, seat.y + seat.height - radius);
                    ctx.lineTo(seat.x, seat.y + radius);
                    ctx.quadraticCurveTo(seat.x, seat.y, seat.x + radius, seat.y);
                    ctx.closePath();
                    ctx.fill();
                    ctx.stroke();

                    ctx.shadowColor = 'transparent';
                    ctx.shadowBlur = 0;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 0;

                    // Draw seat labels
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 12px Inter, system-ui, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    const label = seat.seatName || `${seat.rowName || seat.row}-${seat.column}`;
                    ctx.fillText(label, seat.x + seat.width / 2, seat.y + seat.height / 2);

                    // Draw status indicator
                    if (seat.status !== 'available') {
                        ctx.fillStyle = statusColor;
                        ctx.beginPath();
                        ctx.arc(seat.x + seat.width - 8, seat.y + 8, 4, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                });

                ctx.restore();
            }

            getSeatStatusColor(status) {
                switch (status) {
                    case 'available': return '#4CAF50';
                    case 'occupied': return '#F44336';
                    case 'reserved': return '#FF9800';
                    case 'disabled': return '#9E9E9E';
                    default: return '#4CAF50';
                }
            }

            adjustBrightness(hex, percent) {
                const num = parseInt(hex.replace('#', ''), 16);
                const amt = Math.round(2.55 * percent);
                const R = (num >> 16) + amt;
                const G = (num >> 8 & 0x00FF) + amt;
                const B = (num & 0x0000FF) + amt;
                return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                    (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                    (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
            }
        }

        // Initialize the seating canvas
        const seatingCanvas = new SeatingCanvas('seatingCanvas');
    </script>
</body>
</html> 